<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GPS and Sound Data Collection</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
  <link rel="stylesheet" href="assets/style.css">
</head>
<body>

    <div class="container">
        <div class="lang-selector">
            <!-- Default language set to English / Lingua predefinita impostata su Inglese -->
            <select id="langSelect">
                <option value="it">ðŸ‡®ðŸ‡¹ Italiano</option>
                <option value="en" selected>ðŸ‡¬ðŸ‡§ English</option>
            </select>
        </div>
        
        <h1 id="title"><i class="bi bi-geo-alt-fill"></i> GPS and Sound Data Collection <i class="bi bi-soundwave"></i></h1>
        
        <div id="firebaseStatus" class="firebase-status disconnected">
            <div class="firebase-dot"></div>
            <span id="firebaseText">Local mode - data stored on device only</span>
        </div>
        
        <div id="error" class="error" style="display: none;"></div>
        
        <div class="settings">
            <div class="setting-group">
                <label for="mode" id="labelMode">Collection mode:</label>
                <select id="mode">
                    <option value="walking">Walking (3 sec)</option>
                    <option value="cycling">Cycling (2 sec)</option>
                    <option value="driving">Driving (2 sec)</option>
                    <option value="stationary">Fixed point (30 sec)</option>
                    <option value="long">Long duration (60 sec)</option>
                    <option value="custom">Manual</option>
                </select>
            </div>
            <div class="setting-group">
                <label for="freq" id="labelFreq">Frequency (seconds):</label>
                <input type="number" id="freq" min="1" max="3600" value="3" step="1" disabled>
            </div>
        </div>
        
        <div class="controls">
            <button id="btnStart" class="btn-start"><i class="bi bi-play-fill"></i> Start Collection</button>
            <button id="btnStop" class="btn-stop" disabled><i class="bi bi-stop-fill"></i> Stop Collection</button>
        </div>
        
        <div class="controls">
            <button id="btnFirebase" class="btn-firebase"><i class="bi bi-cloud-upload"></i> Connect Firebase</button>
            <button id="btnExport" class="btn-export"><i class="bi bi-download"></i> Export CSV</button>
        </div>
        
        <div class="controls">
            <button id="btnClear" class="btn-clear"><i class="bi bi-trash-fill"></i> Clear Data</button>
        </div>
        
        <div class="status">
            <div class="status-item">
                <span class="status-label" id="labelStatus">Status:</span>
                <span class="status-value" id="status">Waiting</span>
            </div>
            <div class="status-item">
                <span class="status-label" id="labelCount">Data collected:</span>
                <span class="status-value" id="count">0</span>
            </div>
            <div class="status-item">
                <span class="status-label" id="labelLastGPS">Last position:</span>
                <span class="status-value" id="gps">-</span>
            </div>
            <div class="status-item">
                <span class="status-label" id="labelLastSound">Last sound level:</span>
                <span class="status-value" id="sound">-</span>
            </div>
        </div>
        
        <div class="data-table">
            <table>
                <thead>
                    <tr>
                        <th id="thTime">Timestamp</th>
                        <th id="thLat">Latitude</th>
                        <th id="thLng">Longitude</th>
                        <th id="thDB">Level dB</th>
                    </tr>
                </thead>
                <tbody id="tbody">
                    <tr>
                        <td colspan="4" style="text-align: center; color: #999;" id="nodata">No data collected</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Firebase Modal (no session field shown to the user) / Modal Firebase (nessun campo sessione visibile all'utente) -->
    <div id="modalFirebase" class="modal">
        <div class="modal-content">
            <h2 id="modalTitle">Firebase Connection</h2>
            <p id="modalDesc">Enter Firebase credentials to save data to cloud in real-time.</p>
            
            <div class="setting-group">
                <label for="modalDbUrl">Database URL:</label>
                <input type="text" id="modalDbUrl" placeholder="https://your-project.firebaseio.com">
                <div class="help-text">Find this URL in Firebase Console â†’ Realtime Database</div>
            </div>
            
            <!-- Session is now created automatically and hidden from the user.
                 La sessione ora viene creata automaticamente ed Ã¨ nascosta all'utente. -->
            
            <div class="modal-buttons">
                <button id="btnModalCancel" class="btn-cancel">Cancel</button>
                <button id="btnModalConnect" class="btn-confirm">Connect</button>
            </div>
        </div>
    </div>

    

<script type="module" src="assets/app.js"></script>
</body>
</html>
